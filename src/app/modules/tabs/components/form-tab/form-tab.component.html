
<!-- titulo -->
<div class="form-group">
  <div class="p-3 mt-1">
    <h4 class="mt-1" *ngIf="this.contextualitzacio !== 'Globalitat del cas'">{{ "TABTITLE.titleAutonomia" | translate }} {{this.contextualitzacio | titlecase}}
    </h4>
    <h4 class="mt-1" *ngIf="this.contextualitzacio === 'Globalitat del cas'">{{ "TABTITLE.titleGloablitat" | translate }} {{this.contextualitzacio | titlecase}}
    </h4>
  </div>
</div>
<!--Factores Economicos-->
<ng-template #valoration let-modal >
  <div class="modal-header">
    <h4 class="modal-title" id=""><span class="text-primary">La família/unitat conviència té dificultats per:</span></h4>
  </div>
  <form *ngIf="preguntaEconomica">
    <div class="modal-body">
      <div class="form-group col-xl-12">
        <ng-template ngFor [ngForOf]="data?.factorEconomic" let-economic let-x="index">
          <label class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input"
                   [ngModel]="getPreguntaEconomica(economic)"
                   (ngModelChange)="addPreguntaEconomica(economic,$event)"
            name="x{{x}}">
            <span class="custom-control-label"></span>
            <span class="custom-control-description"><b>{{x+1}}.</b> {{economic.descripcio}}</span>
          </label>
        </ng-template>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline-dark" (click)="getRiscEconomic(); modal.dismiss('Cross click')">Guardar</button>
      <button type="button" class="btn btn-primary" aria-label="Close" (click)="modal.dismiss('Cross click');CopiaOn()">Cancelar</button>
    </div>
  </form>
</ng-template>
<!--/ Factores Economicos -->
<!--/ titulo -->
<form #formTab="ngForm" ngNativeValidate (ngSubmit)="emitEnd()" *ngIf="data && value">
  <div class="card-body pt-0">
    <ng-template [ngIf]="contextualitzacio.toLocaleUpperCase() !== 'GLOBALITAT DEL CAS'">
    <div class="p-3 bg-primary border border-dark">
      <h5 class="text-white ">Situació social</h5>
    </div>
    <div class="form-group  row bg-grey-300 m-0 mt-3 mb-0 ">
    <ng-template ngFor [ngForOf]="data.ambits" let-ambit let-firts="index">
      <ng-template ngFor [ngForOf]="ambit.entorns" let-entorn let-e="index">
        <ng-template [ngIf]="(groupRelacional.social && entorn.descripcio === 'Entorn Social' )
      || (groupRelacional.family && entorn.descripcio === 'Entorn Familiar')
      || (groupRelacional.school && entorn.descripcio === 'Entorn Escolar')
      ||(groupMaterial.house && entorn.descripcio === 'Entorn habitatge' )
      || (groupMaterial.economic && entorn.descripcio === 'Entorn Económic')
      || (groupMaterial.work && entorn.descripcio === 'Entorn Laboral')
       || (entorn.descripcio===contextualitzacio && !groupRelacional.school && !groupRelacional.family
      && !groupRelacional.social && !groupMaterial.economic && !groupMaterial.work && !groupMaterial.house)">
          <div *ngIf="contextualitzacio === ambit.descripcio && contextualitzacio !== 'Autonomia'" class="opaco p-2 col-md-12 mb-3">
            <h6 class="text-white ">{{entorn.descripcio}}</h6>
          </div>
          <ng-template ngFor [ngForOf]="entorn.preguntes" let-pregunta let-i="index">

            <div class="container-fluid form-group row col-12 py-2">
              <div  class="border-top border-dark p-2 col-md-12 mb-3 desaparece" style="text-align: center;">
                <h6 class=" ">{{pregunta.social}}</h6>
              </div>
              <!-- Situacion social Basica -->
              <div class="col-xl-5 aparece" *ngIf="!llistaPE(pregunta.id.toString())">
                <div class="col-12">
                  <label *ngIf="i === 0 || pregunta.social.includes('Administració deficient dels ingressos (E.3)')" class="col-12" for="ssb00" >{{ "TABLE.basicSocialSituation" | translate }} </label>
                  <label *ngIf="i !== 0 "class="desaparece">{{ "TABLE.basicSocialSituation" | translate }}</label>
                <div *ngIf="!pregunta.social.includes('Ingressos insuficients (E.2)')" class="position-relative">
                  <a href="/dsdiba/model-pdf/{{pregunta.id}}"> <input type="text" class="form-control " [value]= "pregunta.social " disabled  ></a>
                  <i class= "fa fa-question-circle position-absolute top-right" aria-hidden="true" [ngbPopover]="pregunta.definicio" placement="right" triggers="mouseenter:mouseleave" [popoverTitle]="pregunta.social" container="body"></i>
                </div>
                </div>
              </div>
              <div class="col-xl-5 pr-0" *ngIf="llistaPE(pregunta.id.toString())" >
                <div class="col-12">
                  <div class="position-relative col-3 pt-1 pl-0 pb-4" *ngIf=" i === 0 ">
                    <button type="button" class=" col-12 btn btn-outline-primary" [disabled]="getPreguntaDisabled(pregunta.id)" (click)="openPreg(pregunta.social,pregunta.id,ambit,entorn,valoration);" ><i class="fa fa-search-plus" aria-hidden="true"></i> Valoracio </button>
                  </div>
                  <label *ngIf="i === 0" class="col-12 pl-5" for="ssb00" >{{ "TABLE.basicSocialSituation" | translate }} </label>
                  <label *ngIf="i !== 0 "class="desaparece">{{ "TABLE.basicSocialSituation" | translate }}</label>
                  <!-- situacio social De Ingressos insuficients-->
                  <div class="form-group row col-12 pr-0 mr-0 pl-5">
                    <div class="position-relative col-12 pl-0 pr-0">

                      <a href="/dsdiba/model-pdf/{{pregunta.id}}"><input  type="text" class="form-control col-12  "[value]= "pregunta.social " disabled ></a>
                      <i class= "fa fa-question-circle position-absolute top-right" aria-hidden="true" [ngbPopover]="pregunta.definicio" placement="right" triggers="mouseenter:mouseleave" [popoverTitle]="pregunta.social" container="body"></i>
                    </div>

                  </div>
                </div>
                <!--/ situacio social De Ingressos insuficients-->
              </div>
              <!--/ Situacion social Basica -->

              <!-- Aplicatiu -->
              <div class="col-xl-1"  >
                <div class="col-12" *ngIf="!llistaPE(pregunta.id.toString())" >
                  <div class="apl form-group align-items-center col-12 text-center">
                    <label *ngIf=" i === 0|| pregunta.social.includes('Administració deficient dels ingressos (E.3)')" > {{ "TABLE.apl" | translate }}</label>
                    <label *ngIf="i !== 0 " class="desaparece">{{ "TABLE.apl" | translate }}</label>
                    <label class="custom-control custom-checkbox p-0 pl-2 apply">
                      <input type="checkbox"
                             class="custom-control-input position-relative"
                             [disabled]="getPreguntaDisabled(pregunta.social)"
                             [ngModel]="getFirstPregunta(pregunta.id , ambit, entorn)"
                             (click)=" newPregunta(pregunta.social , pregunta.id , ambit, entorn);"
                             name="aplica{{e}}{{i}}">
                      <span class="custom-control-label"></span>
                      <span class="custom-control-description"></span>
                    </label>
                  </div>
                </div>
              </div>
              <!--/ Aplicatiu -->

              <!-- Persones -->
              <div class="col-xl-2" *ngIf="!llistaPE(pregunta.id.toString())">
                <div class="col-12">
                  <label  *ngIf=" i === 0 || pregunta.social.includes('Administració deficient dels ingressos (E.3)')" for="t2person" >{{ "TABLE.person" | translate }} </label>
                  <label *ngIf="i !== 0 " class="desaparece">{{ "TABLE.person" | translate }}</label>
                  <div  class="input-group mb-2 mr-sm-2">
                    <div class="input-group-prepend">
                      <div *ngIf="getFirstPregunta(pregunta.id , ambit, entorn) && getFirstPregunta(pregunta.id , ambit, entorn )?.persona !== null" class="input-group-text " (click)="addPreguntaRepeat(pregunta.social , pregunta.id , ambit, entorn) ">
                      <i class="fa fa-user-plus"> </i>
                      </div>
                    </div>
                    <select class="form-control" id="t2person" #t2person="ngModel"
                            [value]="cleanSelects"
                            [disabled]="!getFirstPregunta(pregunta.id , ambit, entorn ) "
                            [ngModel]="getFirstPregunta(pregunta.id , ambit, entorn )?.persona"
                            (change)="changePersona( getFirstPregunta( pregunta.id , ambit, entorn ), t2person.value)"
                            [compareWith]="compare"
                            name="persona{{e}}{{i}}">
                      <option value="" *ngIf="!getFirstPregunta(pregunta.id , ambit, entorn )"></option>
                      <option [ngValue]="null" *ngIf="getFirstPregunta(pregunta.id , ambit, entorn )"> {{ "TABLE.unidadFamiliar" | translate }} </option>
                      <option *ngFor="let person of getFilterPersonas(pregunta.id,getFirstPregunta(pregunta.id,ambit,entorn)?.persona)" [ngValue]="person"> {{person?.tipusPersona?.descripcio}} </option>
                    </select>
                  </div>
                </div>
              </div>
              <!--/ Persones -->
              <!-- Severity -->
              <div class="col-xl-1" *ngIf="!llistaPE(pregunta.id.toString())">
                <div class="col-12">
                  <label *ngIf=" i === 0 || pregunta.social.includes('Administració deficient dels ingressos (E.3)')" for="t10severity" >{{ "TABLE.severity" | translate }} <i class="fa fa-question-circle"

                                                                                 aria-hidden="true" [ngbPopover] =  "'EMERGENTS.Gravetat' | translate "
                                                                                 placement="right"
                                                                                 triggers="mouseenter:mouseleave" [popoverTitle]=" 'TABLE.severity' | translate  "
                                                                                 container="body"></i></label>
                  <label *ngIf="i !== 0 " class="desaparece">{{ "TABLE.severity" | translate }}</label>
                  <select class="form-control" id="t10severity" #t10severity="ngModel"
                          [required]="getFirstPregunta(pregunta.id , ambit, entorn)"
                          [value]="cleanSelects"
                          [disabled]="!getFirstPregunta(pregunta.id , ambit, entorn)"
                          [ngModel]="getFirstPregunta(pregunta.id , ambit, entorn)?.gravetat?.descripcio"
                          (change)="getValueGravetat(getFirstPregunta(pregunta.id , ambit, entorn), ambit , entorn , t10severity.value)"
                          name="severitySelected{{e}}{{i}}">
                    <option disabled selected value></option>
                    <option *ngFor="let option of pregunta.selectors " [value]="option.gravetat.descripcio"> {{option.gravetat.descripcio}}  </option>
                  </select>
                </div>
              </div>
              <!--/ Severity -->
              <!-- Frequencia -->
              <div class="col-xl-1" *ngIf="!llistaPE(pregunta.id.toString())">
                <div class="col-12">
                  <label *ngIf=" i === 0 || pregunta.social.includes('Administració deficient dels ingressos (E.3)')" for="t1frequency" >{{ "TABLE.frequency" | translate }} <i class="fa fa-question-circle"
                                                                                   aria-hidden="true"
                                                                                    [ngbPopover] =  "'EMERGENTS.Frequencia' | translate "
                                                                                   placement="right"
                                                                                   triggers="mouseenter:mouseleave"
                                                                                   [popoverTitle]=" 'TABLE.frequency' | translate  "
                                                                                   container="body"></i></label>
                  <label  *ngIf="i !== 0 " class="desaparece">{{ "TABLE.frequency" | translate }}</label>
                  <select class="form-control" id="t1frequency" #t1frequency="ngModel" [required]="getFirstPregunta(pregunta.id,ambit, entorn)"
                          [value]="cleanSelects"
                          [disabled]="!getFirstPregunta(pregunta.id,ambit, entorn)"
                          [ngModel]="getFirstPregunta(pregunta.id,ambit, entorn)?.frequencia?.descripcio"
                          name="frequencySelected{{e}}{{i}}"
                          (change)="getValueFrequencia(getFirstPregunta(pregunta.id,ambit, entorn) , pregunta.id , t1frequency.value) ">
                    <option disabled selected value></option>
                    <option  *ngFor="let frequencia of getFrequencia(getFirstPregunta(pregunta.id,ambit, entorn)?.gravetat?.descripcio,pregunta.selectors)" [value]="frequencia.frequencia.descripcio" >{{frequencia.frequencia.descripcio}}</option>
                  </select>
                </div>
              </div>
              <!--/ Frequencia -->
              <!-- riskFactors sense valoracio economica-->
              <div class="col-xl-2" *ngIf="!llistaPE(pregunta.id.toString())" >
                <div class="col-12">
                <label *ngIf=" i === 0 || pregunta.social.includes('Administració deficient dels ingressos (E.3)')" for="t4riskFactor" >{{ "TABLE.riskFactors" | translate }}</label>
                  <label *ngIf="i !== 0 " class="desaparece">{{ "TABLE.riskFactors" | translate }}</label>
                <input type="text"
                       [ngClass]="{'warning' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'RISC',
                                   'danger' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'ALT RISC',
                                   'success' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'VULNERABILITAT',
                                   'info' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'SENSE VALORACIÓ' }"
                       class="form-control text-center" id="t4riskFactor"
                       disabled
                       [value]="getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio">
                </div>
              </div>
              <!-- riskFactors amb valoracio economica-->
              <div class="col-xl-6" *ngIf="llistaPE(pregunta.id.toString())" >
                <div class="col-12">
                  <div class="position-relative col-3 pl-0 pt-2 pb-5" *ngIf=" i === 0 ">
                  </div>
                <label *ngIf=" i === 0" for="t3riskFactor" >{{ "TABLE.riskFactors" | translate }}</label>
                <input type="text"
                       [ngClass]="{'warning' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'RISC',
                                   'danger' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'ALT RISC',
                                   'success' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'VULNERABILITAT',
                                   'info' : getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'SENSE VALORACIÓ' }"
                       class="form-control text-center" id="t3riskFactor"
                       disabled
                       [value]="getFirstPregunta(pregunta.id,ambit, entorn)?.factor?.descripcio">
              </div>
              </div>
            </div>
               <!--Bucle for para cada fila  -->
              <ng-container *ngFor="let method of getPreguntas(pregunta.id , ambit, entorn)  ; let x = index">
                <ng-container *ngIf="method.situacioSocial.id === pregunta.id && x!= 0 ">
                  <!-- Situacio Social-->
                  <div class="container-fluid form-group row col-12 py-2">
                  <div class="col-xl-5">
                  </div>
                  <!--/ Situacio Social-->

                  <!--Aplicatiu -->
                  <div class="col-xl-1">
                    <div class="col-12">
                      <div class="form-group align-items-center col-12 text-center">
                          <i class="fa
                           fa-times" style="font-size: x-large" aria-hidden="true" (click)="deleteRepeat(method)"></i>
                      </div>
                    </div>
                  </div>
                  <!--/ Aplicatiu -->

                  <!-- Persones -->
                  <div class="col-xl-2">
                  <div class="col-12">
                    <label class="desaparece">{{ "TABLE.person" | translate }}</label>
                    <div class="input-group mb-2 mr-sm-2">
                      <select class="form-control" id="rpeatPersons" #rpeatPersons="ngModel"
                              [ngModel]="getPreguntaRepeat(method.id,ambit,entorn)?.persona"
                              (change)="changePersona(getPreguntaRepeat(method.id,ambit,entorn), rpeatPersons.value)"
                              name="personasdfc{{i}}{{x}}"
                              [compareWith]="compare">
                        <option disabled selected [ngValue]="null" ></option>
                        <option *ngFor="let persona of getFilterPersonas(method.situacioSocial.id,getPreguntaRepeat(method.id,ambit,entorn)?.persona)" [ngValue]="persona"> {{persona.tipusPersona.descripcio}}</option>
                      </select>
                    </div>
                  </div>
                </div>

                  <!--/ Persones -->

                  <!-- Severity -->

                  <div class="col-xl-1">
                    <div class="col-12">
                      <label class="desaparece">{{ "TABLE.severity" | translate }}</label>
                      <select class="form-control" #severID="ngModel"
                              [value]="cleanSelects"
                              [ngModel]="getPreguntaRepeat(method.id,ambit,entorn)?.gravetat?.descripcio"
                              (change)="getValueSeverity(getPreguntaRepeat(method.id,ambit,entorn),severID.value)"
                              id="severID"
                              name="severity22{{i}}{{x}}">
                        <option disabled selected value></option>
                        <option *ngFor="let option of pregunta.selectors " [value]="option.gravetat.descripcio"> {{option.gravetat.descripcio}}  </option>
                      </select>
                    </div>
                  </div>
                  <!--/ Severity -->
                  <!-- Frequencia -->
                  <div class="col-xl-1">
                    <div class="col-12">
                      <label class="desaparece">{{ "TABLE.frequency" | translate }}</label>
                      <select class="form-control" id="t16frequency" #t16frequency="ngModel"
                              [required]="pregunta.apl"
                              [value]="cleanSelects"
                              [ngModel]="getPreguntaRepeat(method.id,ambit,entorn)?.frequencia?.descripcio"
                              (change)="getFrequenciRepeat(getPreguntaRepeat(method.id,ambit,entorn), t16frequency.value)"
                      name="frequensdci{{x}}{{i}}">
                          <option disabled selected value></option>
                          <option *ngFor="let frequencia of getFrequencia(getPreguntaRepeat(method.id,ambit,entorn)?.gravetat?.descripcio,pregunta.selectors)" [value]="frequencia.frequencia.descripcio"> {{frequencia.frequencia.descripcio}}  </option>
                      </select>
                    </div>
                  </div>
                  <!--/ Frequencia -->
                  <!-- riskFactors -->
                  <div class="form-group col-xl-2">
                    <div class="col-12">
                      <label  class="desaparece">{{ "TABLE.riskFactors" | translate }}</label>
                    <input type="text"
                           [ngClass]="{'warning' : getPreguntaRepeat(method.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'RISC',
                                   'danger' : getPreguntaRepeat(method.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'ALT RISC',
                                   'success' : getPreguntaRepeat(method.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'VULNERABILITAT',
                                   'info' : getPreguntaRepeat(method.id,ambit, entorn)?.factor?.descripcio?.toUpperCase() === 'SENSE VALORACIÓ' }"
                           class="form-control text-center" id="t5RiskFactor"
                           disabled
                           [value]="getPreguntaRepeat(method.id,ambit, entorn)?.factor?.descripcio">
                    </div>
                  </div>
                </div>
                </ng-container>
              </ng-container>
          </ng-template>


        </ng-template>



      </ng-template>
      <div class="form-group row col-xl-12 px-3" *ngIf="(contextualitzacio === 'MATERIAL I INSTRUMENTAL' && ambit.descripcio === 'MATERIAL I INSTRUMENTAL')" >
        <div class="col-12">
          <ng-template [ngIf]="(!groupMaterial.work)">
            <button class="btn btn-primary mr-3"(click)="groupMaterial.work = true" > <i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn de treball </button>
          </ng-template>
          <ng-template [ngIf]="(!groupMaterial.economic )">
            <button class="btn btn-primary mr-3" (click)="groupMaterial.economic = true" ><i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn economic </button>
          </ng-template>
          <ng-template [ngIf]="(!groupMaterial.house)">
            <button  class="btn btn-primary mr-3" (click)="groupMaterial.house = true" ><i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn d'habitatge </button>
          </ng-template>
        </div>
      </div>
      <div class="form-group row col-xl-12 px-3" *ngIf="(contextualitzacio === 'RELACIONAL' && ambit.descripcio === 'RELACIONAL')">
          <ng-template [ngIf]="(!groupRelacional.social)">
            <button class="btn btn-primary mr-3"(click)="groupRelacional.social = true" > <i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn social </button>
          </ng-template>
          <ng-template [ngIf]="(!groupRelacional.family )">
            <button class="btn btn-primary mr-3" (click)="groupRelacional.family = true" ><i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn familiar </button>
          </ng-template>
          <ng-template [ngIf]="(!groupRelacional.school)">
            <button  class="btn btn-primary mr-3" (click)="groupRelacional.school = true" ><i class="fa fa-plus" aria-hidden="true"></i> Afegir entorn escolar </button>
          </ng-template>
      </div>
    </ng-template>
    </div>
    </ng-template>
    <div class="p-3 bg-secondary mt-3 border border-dark">
      <h5 class="text-white">Factors de Contextualització <i class="fa fa-question-circle"
                                                 aria-hidden="true"
                                                 [ngbPopover] =  "'EMERGENTS.Factorsdecontext' | translate "
                                                 placement="right"
                                                 triggers="mouseenter:mouseleave"
                                                 popoverTitle=" Contextualització "></i> </h5>
    </div>

    <ng-template [ngIf]="!viewContext">
      <ng-template [ngIf]="contextualitzacio.toUpperCase()!=='GLOBALITAT DEL CAS'">
      <div class="form-group row border m-0 mt-3 mb-0">
        <button type="button" class="btn btn-primary mr-3 col-xl-12" (click)="viewContext = true" ><i class="fa fa-arrow-down" aria-hidden="true"></i> Expandir Factors De Context  <i class="fa fa-arrow-down" aria-hidden="true"></i> </button>
      </div>
      </ng-template>
    </ng-template>

    <ng-template [ngIf]="viewContext">
    <div class="form-group row bg-grey-300 border m-0 mt-3 mb-0">
      <ng-template ngFor [ngForOf]="data.ambits" let-ambit>
      <ng-template ngFor [ngForOf]="ambit.factors_context" let-cont let-c="index">
          <ng-template [ngIf]="cont.ambit.descripcio === contextualitzacio">
            <div *ngIf="c===0 || cont.primera || cont.nen" class="opaco p-2 col-md-12 mb-3">

              <ng-template [ngIf] = "cont.nen">
                <h6 class="text-white ">Infants</h6>
              </ng-template>

              <ng-template [ngIf] = "!cont.nen">
                <h6 class="text-white ">{{cont.gravetat.descripcio}}</h6>
              </ng-template>
            </div>

            <div class="form-group row col-xl-12 py-2">
              <div  class="border-top border-dark p-2 col-md-12 mb-3 desaparece" style="text-align: center;">
                <h6 class=" ">{{cont.descripcio}}</h6>
              </div>
            <!-- Situacion social Basica -->
            <div class="col-xl-5 aparece">
              <div class="col-12">
              <label *ngIf="c===0 || cont.primera" for="ssb">{{ "TABLE.contextFactor" | translate }}</label>
              <input type="text" class="form-control" id="ssb19" value="{{cont.descripcio}}" disabled>
              </div>
            </div>
            <!--/ Situacion social Basica -->
              <!--aplica mes de una persona-->
              <div class="col-xl-1">
                <div class="col-12" *ngIf="contextualitzacio.toUpperCase() !== 'GLOBALITAT DEL CAS' && cont.fctots">
                  <div class="form-group align-items-center col-12 text-center">
                    <label style="font-size: x-small" *ngIf="c===0 ">  {{ "TABLE.aplMas" | translate }}</label>
                    <label class="aparece" style="font-size: x-small" *ngIf="c!==0 && cont.primera ">  {{ "TABLE.aplMas" | translate }}</label>
                    <label class="desaparece" style="font-size: x-small" *ngIf="c!==0 ">  {{ "TABLE.aplMas" | translate }}</label>
                    <label class="custom-control custom-checkbox apply">
                      <input type="checkbox" class="custom-control-input position-relative" name="aplicaContextMesUn{{c}}"
                             [disabled]="getFirtsContexto(cont.id , ambit , cont )?.membreUnic"
                             [ngModel]="getFirtsContexto(cont.id , ambit , cont )?.mesUc"
                             (click)="newPreguntaContext(ambit , cont, 'mes')">
                      <span class="custom-control-label"></span>
                      <span class="custom-control-description"></span>
                    </label>
                  </div>
                </div>
              </div>
              <!--/ aplica mes de una persona-->
            <!-- Aplica 1 persona-->
            <div class="col-xl-2">
              <div class="col-12">
                <div class="form-group align-items-center col-12 text-center">

                  <label style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() !== 'GLOBALITAT DEL CAS' && cont.fctots && (c===0 )"> {{ "TABLE.aplUna" | translate }}</label>
                  <label style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() === 'GLOBALITAT DEL CAS' && cont.fctots === null && (c===0 )"> {{ "TABLE.apl" | translate }}</label>
                  <label class="aparece" style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() !== 'GLOBALITAT DEL CAS' && cont.fctots && (c!==0 && cont.primera)"> {{ "TABLE.aplUna" | translate }}</label>
                  <label class="aparece" style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() === 'GLOBALITAT DEL CAS' && cont.fctots === null && (c!==0 && cont.primera )"> {{ "TABLE.apl" | translate }}</label>
                  <label class="desaparece" style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() !== 'GLOBALITAT DEL CAS' && cont.fctots && (c!==0 )"> {{ "TABLE.aplUna" | translate }}</label>
                  <label class="desaparece" style="font-size: x-small" *ngIf="contextualitzacio.toUpperCase() === 'GLOBALITAT DEL CAS' && cont.fctots === null && (c!==0 )"> {{ "TABLE.apl" | translate }}</label>


                    <label class="custom-control custom-checkbox apply">
                    <input type="checkbox" class="custom-control-input position-relative"
                            [disabled]="getFirtsContexto(cont.id , ambit , cont )?.mesUc"
                           [ngModel]="getFirtsContexto(cont.id , ambit , cont )?.membreUnic"
                           (click)="newPreguntaContext(ambit , cont, 'unic')"
                           name="aplicaContextUn{{c}}">
                    <span class="custom-control-label"></span>
                    <span class="custom-control-description"></span>
                  </label>
                </div>
              </div>
            </div>
            <!--/ Aplica 1 persona-->

            <!-- Persones -->
            <div class="col-xl-2" >
              <div class="col-12" *ngIf="contextualitzacio.toUpperCase() !== 'GLOBALITAT DEL CAS' && cont.fctots">

                <label for="t1person" *ngIf="c===0">{{ "TABLE.person" | translate }} </label>
                <label class="aparece" for="t1person" *ngIf="c!==0 && cont.primera">{{ "TABLE.person" | translate }} </label>
                <label class="desaparece" for="t1person" *ngIf="(c!==0) ">{{ "TABLE.person" | translate }} </label>

                <select class="form-control" id="t1person" name="personas{{c}}" #t1person="ngModel"
                        [required]="getFirtsContexto(cont.id , ambit , cont )?.membreUnic"
                        [value]="cleanSelects"
                        [disabled]="!getFirtsContexto(cont.id , ambit , cont )?.membreUnic || getFirtsContexto(cont.id , ambit , cont )?.mesUc"
                        [ngModel]="getFirtsContexto(cont.id , ambit , cont )?.persona"
                        (change)="changePersonaSelector(getFirtsContexto(cont.id , ambit , cont ), t1person.value)"
                        [compareWith]="compare">

                  <option disabled selected value></option>
                  <option *ngFor="let person of personsSelector" [ngValue]="person"> {{person.tipusPersona.descripcio}}</option>
                </select>
              </div>
            </div>

            <!--/ Persones -->

            <!-- Severity -->


            <div class="col-xl-2">
              <div class="col-12">
                  <label for="t1riskFactor" *ngIf="c===0 " >{{ "TABLE.types" | translate }}</label>
                  <label class="desaparece" for="t1riskFactor" *ngIf="c!==0 || cont.primera" >{{ "TABLE.types" | translate }}</label>
                  <label class="aparece" for="t1riskFactor" *ngIf="c!==0 && cont.primera" >{{ "TABLE.types" | translate }}</label>
                  <input type="text" class="form-control text-center" id="t1riskFactor"  disabled name="risc{{c}}"
                         [ngModel]="getFirtsContexto(cont.id , ambit , cont )?.factor?.gravetat?.descripcio"
                         [ngClass]="{'danger' : getFirtsContexto(cont.id , ambit , cont )?.factor?.gravetat?.descripcio.toUpperCase() === 'RISC',
                                      'success' : getFirtsContexto(cont.id , ambit , cont )?.factor?.gravetat?.descripcio.toUpperCase() === 'PROTECCI&#211;' }">

              </div>
            </div>
            <!--/ Severity -->
            <!--/ FACTOR DE CONTEXTUALITZACIO -->
            <!--/  riskFactors -->
            </div>
          </ng-template>
        </ng-template>
      </ng-template>
    </div>
  </ng-template>
  </div>
  <div class="form-group row">
    <div class="form-group col-xl-6 float-left">
      <button type="button" class="btn btn-danger ml-3 mb-1" (click)="open(esborrar);"><i class="fa fa-times" aria-hidden="true"></i> Esborrar </button>
    </div>
    <div class="form-group col-xl-6 float-right text-right">
      <button  type="submit"  class="mr-3 mb-1 btn btn-outline-success" ><i class="fa fa-arrow-right" aria-hidden="true"></i> Seguent </button>
    </div>

  </div>
  <ng-template #esborrar let-modal>
    <div class="modal-header">
      <h4 class="modal-title"><span class="text-primary">ALERTA</span></h4>
    </div>
    <form>
      <div class="modal-body">
        <div class="form-group">
          <label >Es perdran les dades introduides <span class="text-primary"></span></label>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-outline-dark" (click)="clean();modal.dismiss('Cross click')">Esborrar</button>
          <button type="button" class="btn btn-primary" aria-label="Close" (click)="modal.dismiss('Cross click')">Cancelar</button>
        </div>
      </div>
    </form>
  </ng-template>

</form>


