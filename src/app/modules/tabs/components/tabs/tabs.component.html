<!-- Search component -->
<app-search>

</app-search>
<br>
<div class="form-group row">
  <div class="form-group col-12 float-right text-right">
    <button  type="button"  class=" btn btn-outline-dark" (click)="routeToExpedient() "> <i class="fa fa-arrow-left" aria-hidden="true"></i> Tornar al expedient </button>
  </div>
</div>

<!--/ Search component -->
<ngb-tabset (tabChange)="beforeChange($event)">

  <ngb-tab id="tab-preventchange1"  [disabled]="false" >
    <ng-template ngbTabTitle> <p> Autonomia funcional </p> </ng-template>

    <ng-template ngbTabContent >
      <app-check-form *ngIf=" (checkTab('Autonomia',1) && !disapear) || forceApear"
                      (stay)=" valueStay($event, 'tab-preventchange2')"
                      [access]="false" >
      </app-check-form>

      <app-ambit-autonomia-tab *ngIf="stay"  [personsSelector]="personActives"
                               (endForm)="enableNext('tab-preventchange2')"
                               (before)= "beforeTab()"
                               [(ngModel)]="diagnostico"
                               [idDiagnostic]="diagnosisID"
                                [nomDiagnostic]="nombreValoracio"
                               [nomExpedient]="expedient.codi"
                                [idProfessional]="idProfesional"
                               [idExpedient]="expedientID"
                                [versio]="diagnostico.versioModel.id">
      </app-ambit-autonomia-tab>

    </ng-template>
  </ngb-tab>
  <ngb-tab id="tab-preventchange2"  [disabled]="tabsActivate.tabAmbitMaterialActivate" >
    <ng-template ngbTabTitle > <p > Material i instrumental</p> </ng-template>
    <ng-template ngbTabContent>

      <app-check-form (entornsMaterial)="entornsMaterial = $event;"
                      *ngIf=" checkTab('MATERIAL I INSTRUMENTAL',2) && !disapear"
                      (stay)="valueStay($event, 'tab-preventchange3')"
                      [access]="true"
                      [ambit]="material"
                      (tabActivated)="tabsActivate.tabAmbitMaterialActivate = false">
      </app-check-form>

      <app-ambit-material-tab *ngIf="stay"
                              (endForm)="enableNext('tab-preventchange3')"
                              (before)="beforeTab()"
                              [groupMaterial] ="entornsMaterial"
                              [(ngModel)]="diagnostico"
                              [personsSelector]="personActives"
                              [idDiagnostic]="diagnosisID"
                              [nomDiagnostic]="nombreValoracio"
                              [nomExpedient]="expedient.codi"
                              [idProfessional]="idProfesional"
                              [idExpedient]="expedientID"
                              [versio]="diagnostico.versioModel.id">
      </app-ambit-material-tab>

    </ng-template>
  </ngb-tab>
  <ngb-tab id="tab-preventchange3" [disabled]="tabsActivate.tabAmbitRelacionalActivate">
    <ng-template ngbTabTitle > <p > Relacional</p> </ng-template>
    <ng-template ngbTabContent>

      <app-check-form (entornsRelacional)="entornsRelacional = $event;" *ngIf=" checkTab('RELACIONAL',3) && !disapear"  (stay)="valueStay($event, 'tab-preventchange4')"  [access]="true" [ambit]="relacional" (tabActivated)="tabsActivate.tabAmbitRelacionalActivate = false" >
      </app-check-form>

      <app-ambit-relacional-tab *ngIf="stay"  (endForm)="enableNext('tab-preventchange4')" (before)="beforeTab()" [groupRelacional] ="entornsRelacional" [(ngModel)]="diagnostico" [personsSelector]="personActives" [idDiagnostic]="diagnosisID" [nomDiagnostic]="nombreValoracio" [nomExpedient]="expedient.codi"   [idProfessional]="idProfesional"
                                [idExpedient]="expedientID" [versio]="diagnostico.versioModel.id">
      </app-ambit-relacional-tab>
    </ng-template>
  </ngb-tab>
  <ngb-tab id="tab-preventchange4" [disabled]="tabsActivate.tabGlobalitatCasActivate">
    <ng-template ngbTabTitle > <p > Factors de context generals</p> </ng-template>
    <ng-template ngbTabContent>

      <app-globalitat-tab   (endForm)="enableNext('tab-preventchange5')" (before)="beforeTab()" (tabActivated)="tabsActivate.tabGlobalitatCasActivate = false" [(ngModel)]="diagnostico" [personsSelector]="personActives" [idDiagnostic]="diagnosisID"[nomDiagnostic]="nombreValoracio" [nomExpedient]="expedient.codi"  [idProfessional]="idProfesional"
                            [idExpedient]="expedientID" [versio]="diagnostico.versioModel.id">
      </app-globalitat-tab>
    </ng-template>
  </ngb-tab>
  <ngb-tab id="tab-preventchange5" [disabled]="tabsActivate.tabValoracioDiagnosticActivate" >
    <ng-template ngbTabTitle > <p> Valoraci√≥ del Cas</p> </ng-template>
    <ng-template ngbTabContent>

      <app-valoracio-diagnostic-tab  [idExpedient]="expedientID" (before)="beforeTab()" (tabActivated)="tabsActivate.tabValoracioDiagnosticActivate = false" [diagnostico]="diagnostico"  [idDiagnostic]="diagnosisID" [nomDiagnostic]="nombreValoracio" [nomExpedient]="expedient.codi"  [idProfessional]="idProfesional" > </app-valoracio-diagnostic-tab>
    </ng-template>
  </ngb-tab>



</ngb-tabset>
