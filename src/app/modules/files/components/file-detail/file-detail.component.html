<!-- Search component -->
<app-search></app-search>
<!--/ Search component -->

<!-- Form Detail -->
<section id="file-detail">
  <h2 class="text-center mb-4">{{ "TITLE.file-h2" | translate }}</h2>
  <div class="card">
    <div class="card-body">
      <div class="form-group row">
        <!-- File ID -->
        <div class="col-6">
          <div class="col-12">
            <label for="fileId" class="col-form-label">{{ "FORM.fileId" | translate }}</label>
            <input class="form-control" type="text" value="{{expedient[0]?.expedient}}" id="fileId" disabled="disabled">
          </div>
        </div>
        <!--/ File ID -->
        <!-- File Owner -->
        <div class="col-6">
          <div class="col-12">
            <label for="owner" class="col-form-label">{{ "FORM.fileOwner" | translate }}</label>
            <input class="form-control" type="text" value="{{expedient[0]?.professional?.nom}} {{expedient[0]?.professional?.cognom1}} {{expedient[0]?.professional?.cognom2}}" id="owner" disabled="disabled">
          </div>
        </div>
        <!-- File Owner -->
      </div>
      <div class="form-group row">
        <!-- File Name -->
        <div class="col-6">
          <div class="col-12">
            <label for="fileName" class="col-form-label">{{ "FORM.fileName" | translate }}</label>
            <input class="form-control" type="text" value="{{expedient[0]?.nom}}" id="fileName" disabled="disabled">
          </div>
        </div>
        <!--/ File Name -->
        <!-- File Date -->
        <div class="col-6">
          <div class="col-12">
            <label for="fileDate" class="col-form-label">{{ "FORM.fileDate" | translate }}</label>
            <input class="form-control" type="text" value="{{expedient[0]?.data | date:'dd/MM/yyyy'}}" id="fileDate" disabled="disabled">
          </div>
        </div>
        <!--/ File Date -->
        <!-- File Family -->
        <div class="col-6">
          <div class="col-12">
            <label for="totalFamilia" class="col-form-label">{{ "FORM.totalFamilia" | translate }}</label>
            <input class="form-control" type="text" value="{{expedient[0]?.totalFamilia}}" id="totalFamilia" disabled="disabled">
          </div>
        </div>
        <!--/ File Family -->
      </div>
      <div class="form-group row">
        <!-- Unity Family -->
        <div class="col-12">
          <div class="col-12">
            <label class="col-form-label">{{ "FORM.fileUFamily" | translate }}</label>
            <app-table-list [tableData]="dataUnityFamily"
                            [options]="optionsUF"
                            [rowTemplate]="unityFamily"
                            (reloadData)="reloadDataTable()">

              <ng-template #unityFamily let-item>
                  <td class="text-center" [ngClass]="{'info' : item.referencia === true}">
                    {{item.tipusPersona.descripcio}} <i *ngIf="item.referencia === true" class="icon ion-information-circled float-left" placement="right" ngbTooltip="Persona de referencia"></i>
                  </td>
                  <td class="text-center" [ngClass]="{'info' : item.referencia === true}">
                    {{item.sexe}}
                  </td>
                  <td class="text-center" [ngClass]="{'info' : item.referencia === true}">
                    {{item.dataNaixement | date:'dd/MM/yyyy'}}
                  </td>
                  <td class="text-center" [ngClass]="{'info' : item.referencia === true}">
                    {{item.dataAlta | date:'dd/MM/yyyy'}}
                  </td>
                  <td class="text-center" [ngClass]="{'info' : item.referencia === true}">
                    {{item.dataBaixa | date:'dd/MM/yyyy'}}
                    <button *ngIf="item.dataBaixa === '' || item.dataBaixa === null" class="btn btn-outline-primary" (click)="open(content)">
                      {{ "TABLE.toUnsubscribe" | translate }}
                    </button>

                    <!-- Modal -->
                    <ng-template #content let-modal>
                      <div class="modal-header">
                        <h4 class="modal-title" id="modal-unsubscribe"><span class="text-primary">{{ "TABLE.toUnsubscribe" | translate }}:</span> {{item.tipusPersona.descripcio}}</h4>
                        <button type="button" class="close bg-primary text-white" aria-label="Close" (click)="modal.dismiss('Cross click')">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <form>
                        <div class="modal-body">
                          <div class="form-group">
                            <label for="date-unsubscribe">{{ "TABLE.dataUnsubscribe" | translate }} <span class="text-primary">*</span></label>
                            <div class="input-group">
                              <input id="date-unsubscribe" class="form-control" placeholder="dd-mm-yyyy" type="date">
                            </div>
                          </div>
                          <div class="form-group" *ngIf="item.referencia === true">
                            <label for="date-unsubscribe">{{ "TABLE.newRef" | translate }} <span class="text-primary">*</span></label>
                            <div class="input-group">
                              <select id="new-person-ref" class="form-control">
                                <option>Mare</option>
                                <option>Fill</option>
                                <option>Filla</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button type="submit" class="btn btn-outline-dark" (click)="modal.close('Save click')">{{ "FORM.save" | translate }}</button>
                          <button type="button" class="btn btn-primary" aria-label="Close" (click)="modal.dismiss('Cross click')">{{ "FORM.cancel" | translate }}</button>
                        </div>
                      </form>
                    </ng-template>
                    <!--/ Modal -->
                  </td>
              </ng-template>
            </app-table-list>
          </div>
        </div>
      </div>
      <div class="form-group row">
        <div class="col-12 text-center pt-4 pb-3">
          <button type="button" class="btn btn-primary btn-large" (click)="open(content)">
            {{ "TABLE.newMember" | translate }}
          </button>

          <!-- Modal -->
          <ng-template #content let-modal>
            <div class="modal-header">
              <h4 class="modal-title" id="modal-register"><span class="text-primary">{{ "TABLE.toRegister" | translate }}</span></h4>
              <button type="button" class="close bg-primary text-white" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <form>
              <div class="modal-body">
                <div class="form-group">
                  <label class="custom-control custom-checkbox">
                    <input id="person-ref" type="checkbox" class="custom-control-input">
                    <span class="custom-control-label">{{ "TABLE.isPersonRef" | translate }}</span>
                    <span class="custom-control-description"></span>
                  </label>
                </div>
                <div class="form-group">
                  <label for="date-register">{{ "TABLE.dataRegister" | translate }} <span class="text-primary">*</span></label>
                  <div class="input-group">
                    <input id="date-register" class="form-control" placeholder="dd-mm-yyyy" type="date">
                  </div>
                </div>
                <div class="form-group">
                  <label for="relation-register">{{ "TABLE.relation" | translate }} <span class="text-primary">*</span></label>
                  <div class="input-group">
                    <select id="relation-register" class="form-control">
                      <option>Mare</option>
                      <option>Fill</option>
                      <option>Filla</option>
                      <option>Avi</option>
                      <option>Avia</option>
                      <option>Tiet</option>
                      <option>Tieta</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="sex-register">{{ "TABLE.sex" | translate }} <span class="text-primary">*</span></label>
                  <div class="input-group">
                    <select id="sex-register" class="form-control">
                      <option>Home</option>
                      <option>Dona</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label for="date-birthday">{{ "TABLE.birthday" | translate }} <span class="text-primary">*</span></label>
                  <div class="input-group">
                    <input id="date-birthday" class="form-control" placeholder="dd-mm-yyyy" type="date">
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-outline-dark" (click)="modal.close('Save click')">
                  {{ "FORM.save" | translate }}
                </button>
                <button type="button" class="btn btn-primary" aria-label="Close" (click)="modal.dismiss('Cross click')">
                  {{ "FORM.cancel" | translate }}
                </button>
              </div>
            </form>
          </ng-template>
          <!--/ Modal -->

        </div>
      </div>
      <!--/ Unity Family -->
      <!-- File Observation -->
      <div class="form-group row">
        <div class="col-12 px-3">
          <label for="fileObservation" class="col-form-label">
            <i class="fa fa-pencil-square-o"></i> {{ "FORM.fileObs" | translate }}
          </label>
          <textarea class="form-control cdk-textarea-autosize-measuring" rows="3" type="text" value="{{ expedient[expedient?.length - 1].observacions }}" id="fileObservation"></textarea>
        </div>
      </div>
      <!--/ File Observation -->
      <br/>
      <!-- Table Files Valoraciones -->
      <div class="form-group row">
        <div class="col-12 px-3">
          <label for="fileObservation" class="col-form-label">
            <i class="fa fa-eye"></i> {{ "OBSTABLE.obs" | translate }}
          </label>
        </div>
      </div>
      <div class="row">
        <div [ngClass]="{'col-12' : obsData?.length == 1, 'col-6' : obsData?.length > 1}" class="text-center">
          <!-- Table List Diagnosis -->
          <app-table-list [tableData]="obsData"
                          [options]="options"
                          [rowTemplate]="myRowInitDysplay"
                          (reloadData)="reloadData()">
            <ng-template #myRowInitDysplay let-item>
              <td [ngClass]="{'warning' : item.estat === 'BORRADOR', 'success' : item.estat === 'VALIDAT'}">DSDIBA-{{item.data | date:'dd/MM/yyyy'}}</td>
              <td [ngClass]="{'warning' : item.estat === 'BORRADOR', 'success' : item.estat === 'VALIDAT'}">{{item.professional.nom}} {{item.professional.cognom1}} {{item.professional.cognom2}}</td>
              <td [ngClass]="{'warning' : item.estat === 'BORRADOR', 'success' : item.estat === 'VALIDAT'}">
                <a [routerLink]="['/observations', {'id': item.id,'date': item.data}]" > <i class="fa fa-eye"></i> </a>
                <span class="px-2" *ngIf="item.estat==='BORRADOR'"> </span>
                <a *ngIf="item.estat==='BORRADOR'" [routerLink]="['/observations', {'id': item.id,'date': item.data}]" > <i class="fa fa-pencil-square-o"> </i> </a>
              </td>
            </ng-template>
          </app-table-list>
          <!--/ Table List Diagnosis -->
        </div>
        <div class="col-6">
          <!-- Chart -->
          <!--<ngx-charts-line-chart
            class="chart-container"
            [scheme]="colorScheme"
            [schemeType]="schemeType"
            [results]="single"
            [legend]="showLegend"
            (legendLabelClick)="1"
            [gradient]="gradient"
            [xAxis]="showXAxis"
            [yAxis]="showYAxis"
            [showXAxisLabel]="showXAxisLabel"
            [showYAxisLabel]="showYAxisLabel"
            [xAxisLabel]="xAxisLabel"
            [yAxisLabel]="yAxisLabel"
            [autoScale]="autoScale"
            [timeline]="timeline"
            [showGridLines]="showGridLines"
            [curve]="curve"
            [rangeFillOpacity]="rangeFillOpacity"
            [roundDomains]="roundDomains"
            [tooltipDisabled]="true"
            (select)="1">
        </ngx-charts-line-chart>-->
        <!--/ Chart -->
        </div>
      </div>
      <!--/ Table Files Valoraciones -->
      <div class="form-group row">
        <div class="col-12 text-center pt-4 pb-3">
          <button type="button" class="btn btn-primary btn-large" [routerLink]="['/tabs']">
            {{ "FORM.newDiagnosis" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
<!--/ Form Detail -->
